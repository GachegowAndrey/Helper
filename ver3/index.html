<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="style.css">
	<title>Canvas</title>
</head>
<body>
	<div class="Toolbar">
		- Color -<br>
		<img id="redPen" src="res/pen_red.gif" alt="Красная кисть" onclick="changeColor('rgb(212,21,29)', this)">
        <img id="greenPen" src="res/pen_green.gif" alt="Зеленая кисть" onclick="changeColor('rgb(131,190,61)', this)"> 
        <img id="bluePen" src="res/pen_blue.gif" alt="Синяя кисть" onclick="changeColor('rgb(0,86,166)', this)">
	</div>
	<div class="Toolbar">
		- Figures -<br>
       <!--<button onclick="getSquare()">Square</button>
       	<button onclick="getText()">text</button>
       <button onclick="getCircle()">Circle</button>-->
       <img src="res/textIcon.png" onclick="getText()">
       
	 </div>
	<div class="Toolbar">
		- Thickness -<br>
        <img src="res/pen_thin.gif" alt="Тонкая кисть" onclick="changeThickness(1, this)">
        <img src="res/pen_medium.gif" alt="Нормальная кисть" onclick="changeThickness(5, this)"> 
        <img src="res/pen_thick.gif" alt="Толстая кисть" onclick="changeThickness(10, this)">
	</div>
	<div class="canvasContainer">
		<canvas id="canvas" width="800" height="600"></canvas>
	</div>
	
	<div class="Toolbar">
		- Operations -<br>
		<button onclick="saveCanvas()">Save canvas</button>
		<button onclick="clearCanvas()">Clear canvas</button>
		<div id="saveCopyContainer">
			<img id="savedImageCopy"><br>
		</div>
	</div>
<script type="text/javascript">
	var canvas;
	var context;

	var  previousColorElement;

	function changeColor(color, imgElement){

		//Меняем текущий цвет рисования
		context.strokeStyle=color;

		// Меняем стиль элемента <img>, по которому щелкнули
		imgElement.className="Selected";

		// Возвращаем ранее выбранный элемент <img> в нормальное состояние
		if (previousColorElement!=null) {
			previousColorElement.className="";
		}
		previousColorElement=imgElement;
	}

    var previousThicknessElement;
	function changeThickness(thickness, imgElement){
		// Изменяем текущую толщину линии
		context.lineWidth = thickness;

		// Меняем стиль элемента <img>, по которому щелкнули
		imgElement.className = "Selected";

		// Возвращаем ранее выбранный элемент <img> в нормальное состояние
		if (previousThicknessElement!=null) {
			previousThicknessElement.className="0;"
		}
		previousThicknessElement=imgElement;
	}

	window.onload = function () {
		// body...
		canvas=document.getElementById("canvas");
		context= canvas.getContext("2d");

		canvas.onmousedown = startDrawing;
		canvas.touchstart= startDrawing;
		canvas.touchend=stopDrawing;
		canvas.touchcancel=stopDrawing;
		canvas.onmouseup = stopDrawing;
		canvas.onmouseout = stopDrawing;
		canvas.onmousemove = draw;
		canvas.touchmove=draw;
	}
	function startDrawing(e){
		// Начинаем рисовать
		isDrawing=true;

		// Создаем новый путь (с текущим цветом и толщиной линии) 
		context.beginPath();
		// Нажатием левой кнопки мыши помещаем "кисть" на холст
		context.moveTo(e.pageX - canvas.offsetLeft, e.pageY-canvas.offsetTop);
		}


     function draw(e){
     	if (isDrawing==true) {
     		// Определяем текущие координаты указателя мыши
     		var x = e.pageX-canvas.offsetLeft;
     		var y = e.pageY-canvas.offsetTop;

     		// Рисуем линию до новой координаты
     		context.lineTo(x,y);
     		context.stroke();
     	}
     }

function getSquare(){
  //context.fillStyle = "rgb(100,150,185)";
//context.lineWidth = 5;
//context.strokeStyle = "gold";
	context.rect(100,100,50,50);
//context.fill();
context.stroke();
}
function getCircle(){
	//context.fillStyle = "rgb(100,150,185)";
//context.lineWidth = 10;
//context.strokeStyle = "red";
	context.arc(110, 120, 100, 0, 2*Math.PI);
//context.fill();
context.stroke();
}

function getText(e){
	//context.clearRect(0,0,canvas.width,canvas.height);
//isDrawing=true;
	var result =prompt("Enter text");
	var ox =prompt("Enter value of x");
	var oy =prompt("Enter value of y");
	context.font = "bold 40px Verdana,sans-serif";
context.lineWidth = 1;
//context.strokeStyle = "red";
context.strokeText(result, ox,canvas.height-oy);
//isDrawing=false;

}
function stopDrawing() {
    isDrawing = false;	
}
//очистка холста
function clearCanvas(){
	context.clearRect(0,0,canvas.width,canvas.height);
}
//сохранение изображения
var url = canvas.toDataURL("image/jpeg");
function saveCanvas(){
	// Находим элемент <img>
	var imageCopy = document.getElementById("savedImageCopy");

	// Отображаем данные холста в элементе <img>
	imageCopy.src= canvas.toDataURL();
	
	// Показываем элемент <div>, делая изображение видимым
	// делая изображение видимым
	var imageContainer = document.getElementById("savedCopyContainer");
	imageContainer.style.display="block";
   
}

</script>
</body>
</html>